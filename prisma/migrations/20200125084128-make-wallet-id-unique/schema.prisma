generator photon {
  provider = "photonjs"
}

datasource db {
  provider = "sqlite"
  url = "***"
}

model User {
  id       String  @default(cuid()) @id
  email    String  @unique
  password String
  name     String
  maxAmountPerTranscationDollar String
  description String?
  currencyAccounts  CurrencyAccount[]
  targetTransactions Transaction[] @relation(name: "targetUser")
  sourceTransactions Transaction[] @relation(name: "sourceUser")
}

model Currency {
  id       String  @default(cuid()) @id
  name    String  @unique
  exchangeRateDollar String
  addressRegExp String
}

model CurrencyAccount {
  id          String @id @default(cuid())
  walletId    String @unique
  balance     String
  currency    Currency
  user        User
}

model Transaction {
  id          String @id @default(cuid())
  createdAt   DateTime @default(now())
  processedAt DateTime?
  currency    Currency
  amount      String
  target      User @relation(name: "targetUser")
  source      User @relation(name: "sourceUser")
  state       TransactionState
}

enum TransactionState {
  Pending
  Processed
  Failed
}