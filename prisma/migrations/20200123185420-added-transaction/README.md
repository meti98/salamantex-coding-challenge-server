# Migration `20200123185420-added-transaction`

This migration has been generated by Matthias Schaider at 1/23/2020, 6:54:20 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "quaint"."Transaction" (
  "amount" TEXT NOT NULL DEFAULT ''  ,
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "currency" TEXT NOT NULL   REFERENCES "Currency"(id) ON DELETE RESTRICT,
  "id" TEXT NOT NULL   ,
  "processedAt" DATE    ,
  "source" TEXT NOT NULL   REFERENCES "User"(id) ON DELETE RESTRICT,
  "state" TEXT NOT NULL DEFAULT 'Pending'  ,
  "target" TEXT NOT NULL   REFERENCES "User"(id) ON DELETE RESTRICT,
  PRIMARY KEY ("id")
);
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200122102833-address-reg-exp..20200123185420-added-transaction
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url      = "file:dev.db"
 }
 model User {
   id       String  @default(cuid()) @id
@@ -14,8 +14,10 @@
   name     String
   maxAmountPerTranscationDollar String
   description String?
   currencyAccounts  CurrencyAccount[]
+  targetTransactions Transaction[] @relation(name: "targetUser")
+  sourceTransactions Transaction[] @relation(name: "sourceUser")
 }
 model Currency {
   id       String  @default(cuid()) @id
@@ -29,5 +31,22 @@
   walletId    String
   balance     String
   currency    Currency
   user        User
+}
+
+model Transaction {
+  id          String @id @default(cuid())
+  createdAt   DateTime @default(now())
+  processedAt DateTime?
+  currency    Currency
+  amount      String
+  target      User @relation(name: "targetUser")
+  source      User @relation(name: "sourceUser")
+  state       TransactionState
+}
+
+enum TransactionState {
+  Pending
+  Processed
+  Failed
 }
```


